//*********************************************************************************************************************************************************************************
// nws_isetup_control.c
/*---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 * Release Information.
 *---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 *
 * Version:		N-C7 	   - v090
 * Date:		01/10/2020
 * Modifier:	Emilio R. La Greca
 *
 * Original release.
 *
 *-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------*/

#include		<com_defn.h>
#include		<nws_isetup_common.h>
#include		<nwsutils.h>

#if (BUILD_INFO__NCX_DEVICE == COM_DEFN__NCX_DEVICE__NC7)
#include		<nws_isetup_userif_NC7.h>
#include		<tftdspif.h>
#endif

//*********************************************************************************************************************************************************************************
// MODULE
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
// CONSTANTS
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
//
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
// VARIABLES
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
static NWS_ISETUP_COMMON__ControlDetails	mInstallerSetupMenu;
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
// SAVED VALUES
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
//
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
// TIMING
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
//
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
// FUNCTION DECLARES
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
//
//*********************************************************************************************************************************************************************************


//*********************************************************************************************************************************************************************************
// APPLICATION
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
// VARIABLES
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
//
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
// FUNCTION DEFINITIONS
/*---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 * @brief:	Initialises data ready for processing once this state is entered.
 * @param:	None.
 * @retval:	None.
 *-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
void							NWS_ISETUP_CONTROL__InitBeforeStateEntry(void)
{
#if (BUILD_INFO__NCX_DEVICE == COM_DEFN__NCX_DEVICE__NC7)
	NWS_ISETUP_USERIF_NC7__InitBeforeStateEntry( &mInstallerSetupMenu );
#endif
	return;
}
/*---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 * @brief:	User interface update - Installer setup menu state.
 * @param:	vbStateJustEntered - Indicates if this state has just been entered (first time in this fcn).
 * @retval:	None.
 *-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
void							NWS_ISETUP_CONTROL__UserifUpdate(bool vbStateJustEntered)
{
	// Init any data when state just entered
	if ( vbStateJustEntered ) { NWS_ISETUP_CONTROL__InitBeforeStateEntry(); }
	//
	// Clear any button press
	mInstallerSetupMenu.UserAccess.Control.ButtonPressed = NWS_ISETUP_COMMON__CB__NONE_PRESSED;
	//
	// User inteface update
#if (BUILD_INFO__NCX_DEVICE == COM_DEFN__NCX_DEVICE__NC7)
	NWS_ISETUP_USERIF_NC7__UpdateDisplay( &mInstallerSetupMenu );
	NWS_ISETUP_USERIF_NC7__UpdateControl( &mInstallerSetupMenu );
#endif
	//
	// Process any control actions
	switch ( mInstallerSetupMenu.UserAccess.Control.ButtonPressed )
	{
		case NWS_ISETUP_COMMON__CB__CUSTOM_SETUP:
			// Custom setup (Installer Parameters)
			NWSUTILS__AccessConfigMenu_InstallerSetup_CustomSetup();
			break;

		case NWS_ISETUP_COMMON__CB__SETUP_ASSISTANT:
			// Setup Assistant
			NWSUTILS__AccessConfigMenu_InstallerSetup_SetupAssistant();
			break;

		case NWS_ISETUP_COMMON__CB__SYSTEM_INFO:
			// System Info
			NWSUTILS__AccessConfigMenu_InstallerSetup_SystemInfo();
			break;

		case NWS_ISETUP_COMMON__CB__BACK:
			// Back button - Go back to config menu
			NWSUTILS__RevertConfigMenu();
			break;

		default:
#if (BUILD_INFO__NCX_DEVICE == COM_DEFN__NCX_DEVICE__NC7)
			if ( TFTDSPIF__bNoTouchTimeout() ) { NWSUTILS__CancelConfigMenu(); }
#endif
			break;
	}

	return;
}
//*********************************************************************************************************************************************************************************
